<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MELHOR DO QUE JOGO DO BICHO</title>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">
    <style>
        /* --- RESET & GLOBAIS --- */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: #050510;
            background-image: radial-gradient(circle at center, #1a0b00, #000);
            font-family: 'Verdana', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: white;
            user-select: none;
            overflow-x: hidden;
            padding: 20px 10px;
        }

        /* --- ANIMA√á√ïES GLOBAIS --- */
        @keyframes pulseBeat {
            0% { box-shadow: 0 0 10px #ff0055; border-color: #ff0055; }
            50% { box-shadow: 0 0 30px #ff00de; border-color: #ff00de; }
            100% { box-shadow: 0 0 10px #ff0055; border-color: #ff0055; }
        }

        .beat-pulse {
            animation: pulseBeat 0.42s infinite;
        }

        /* --- BOT√ÉO DE CADASTRO --- */
        .register-call-btn {
            background: linear-gradient(45deg, #00ffaa, #00aaff);
            color: #000;
            font-family: 'Russo One', sans-serif;
            font-size: 18px;
            padding: 12px 30px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            margin-bottom: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 170, 0.6);
            text-transform: uppercase;
            animation: bounce 2s infinite;
            z-index: 20;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }

        /* --- CONTAINER DA M√ÅQUINA --- */
        .machine-container {
            background: linear-gradient(180deg, #2b003b, #12001f);
            padding: 20px;
            border-radius: 20px;
            border: 3px solid #ff0055;
            text-align: center;
            width: 100%;
            max-width: 450px;
            position: relative;
            z-index: 10;
            margin-bottom: 20px;
        }

        h1 {
            font-family: 'Russo One', sans-serif;
            margin: 0 0 15px 0;
            text-transform: uppercase;
            background: linear-gradient(to right, #ff0055, #ffcc00); 
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: clamp(24px, 6vw, 32px);
            letter-spacing: 1px;
            text-shadow: 0 0 20px rgba(255, 0, 85, 0.5);
        }

        /* --- HUD (Painel de Info) --- */
        .hud-container {
            background: rgba(0,0,0,0.6);
            border: 1px solid #444;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 15px;
            backdrop-filter: blur(5px);
        }

        .hud-row { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 8px; 
            font-weight: bold; 
            font-size: 12px; 
            text-transform: uppercase; 
            color: #aaa; 
        }
        
        .balance-text { 
            color: #00ffaa; 
            font-size: 20px; 
            text-shadow: 0 0 10px rgba(0,255,170,0.5); 
            font-family: 'Courier New', monospace; 
        }

        input[type="number"] {
            background: #111; border: 1px solid #555; color: #fff; font-size: 18px; 
            width: 80px; padding: 8px; text-align: center; border-radius: 5px; font-weight: bold;
        }

        /* --- ROLOS (Reels) --- */
        .reels-container {
            display: flex; 
            justify-content: space-between; 
            gap: 2%;
            background-color: #000; 
            padding: 10px; 
            border-radius: 15px;
            margin-bottom: 20px; 
            border: 2px solid #333;
            box-shadow: inset 0 0 20px #000;
        }

        .reel {
            background: #fff; 
            width: 32%; 
            height: 24vw; 
            max-height: 110px;
            min-height: 80px;
            border-radius: 10px;
            display: flex; 
            justify-content: center; 
            align-items: center;
            font-size: clamp(35px, 10vw, 60px); 
            color: #333; 
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
            border: 2px solid #d4af37;
            transition: transform 0.1s;
        }
        
        @keyframes spinBlur {
            0% { transform: translateY(0) scale(1); filter: blur(0px); }
            25% { transform: translateY(-10px) scale(0.9); filter: blur(2px); }
            50% { transform: translateY(10px) scale(0.9); filter: blur(2px); }
            100% { transform: translateY(0) scale(1); filter: blur(0px); }
        }

        .spinning { 
            animation: spinBlur 0.1s infinite linear;
            opacity: 0.8;
        }

        /* --- BOT√ÉO DE GIRO --- */
        #spinBtn {
            background: linear-gradient(90deg, #ff930f, #fff95b);
            color: #4a0e0e; border: none; 
            padding: 18px 0; 
            width: 100%;
            font-size: 20px; 
            font-weight: 900; border-radius: 12px;
            font-family: 'Russo One', sans-serif;
            cursor: pointer; text-transform: uppercase; letter-spacing: 1px;
            box-shadow: 0 5px 0 #b86e00, 0 10px 20px rgba(255, 147, 15, 0.4);
            transition: transform 0.1s, box-shadow 0.1s;
            touch-action: manipulation;
        }
        #spinBtn:active { transform: translateY(4px); box-shadow: 0 0 0 #b86e00; }
        #spinBtn:disabled { background: #555; color: #888; box-shadow: none; cursor: not-allowed; transform: translateY(4px); }

        /* --- MODAL DE CADASTRO --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 20000;
            display: none; justify-content: center; align-items: center;
            padding: 20px; backdrop-filter: blur(5px);
        }
        
        .modal-box {
            background: #1a0b2e;
            border: 2px solid #00ffaa;
            border-radius: 15px;
            width: 100%; max-width: 400px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 0 30px rgba(0, 255, 170, 0.3);
            position: relative;
        }

        .modal-title {
            font-family: 'Russo One', sans-serif;
            color: #00ffaa; font-size: 24px; margin-bottom: 20px;
            text-transform: uppercase;
        }

        .form-group { margin-bottom: 15px; text-align: left; }
        .form-group label { display: block; color: #aaa; font-size: 12px; margin-bottom: 5px; font-weight: bold; }
        .form-group input {
            width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #444;
            background: #0f0518; color: white; font-size: 16px; outline: none;
        }
        .form-group input:focus { border-color: #00ffaa; }

        .btn-submit {
            width: 100%; padding: 15px; border-radius: 8px; border: none;
            background: #00ffaa; color: #000; font-weight: bold; font-size: 16px;
            font-family: 'Russo One', sans-serif; cursor: pointer; margin-top: 10px;
        }
        .btn-close-modal {
            position: absolute; top: 10px; right: 15px; background: none; border: none;
            color: #fff; font-size: 24px; cursor: pointer;
        }

        /* --- PAINEL DE CONTROLE / CHEAT --- */
        .admin-panel {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 15px;
            border: 2px dashed #444;
            width: 100%;
            max-width: 450px;
            text-align: center;
        }
        .slider-container {
            display: flex; align-items: center; gap: 10px; margin-top: 10px;
            color: #00d2d3; font-weight: bold; font-size: 14px;
        }
        input[type=range] { flex-grow: 1; accent-color: #ff00de; cursor: pointer; height: 20px; }

        /* --- OVERLAY DE VIT√ìRIA --- */
        #winOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.92); z-index: 9999;
            display: none;
            flex-direction: column; justify-content: center; align-items: center;
            backdrop-filter: blur(8px);
            padding: 20px;
        }

        .sunburst {
            position: absolute; width: 200vmax; height: 200vmax; 
            background: repeating-conic-gradient(from 0deg, rgba(255, 215, 0, 0.1) 0deg 15deg, transparent 15deg 30deg);
            animation: rotateSun 20s linear infinite;
            z-index: -1;
        }

        .win-title {
            font-family: 'Russo One', sans-serif;
            font-size: clamp(40px, 12vw, 80px);
            text-transform: uppercase;
            text-align: center;
            line-height: 1.1;
            margin-bottom: 10px;
            transform: scale(0);
            animation: elasticPop 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        
        .tier-ganho { color: #ffffff; -webkit-text-stroke: 2px #d35400; text-shadow: 0 0 30px rgba(211, 84, 0, 0.8); }
        .tier-grande { color: #ffeb3b; -webkit-text-stroke: 2px #b86e00; text-shadow: 0 0 40px rgba(255, 204, 0, 0.9); }
        .tier-super { color: #00e5ff; -webkit-text-stroke: 2px #006064; text-shadow: 0 0 50px rgba(0, 229, 255, 1); }
        .tier-mega { color: #e040fb; -webkit-text-stroke: 2px #4a148c; text-shadow: 0 0 60px rgba(224, 64, 251, 1); }
        .tier-super-mega { 
            background: linear-gradient(to bottom, #ffd700, #ff8c00); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; -webkit-text-stroke: 1px #fff; 
            filter: drop-shadow(0 0 10px gold); 
        }

        .win-amount {
            font-family: 'Russo One', sans-serif; 
            font-size: clamp(50px, 15vw, 90px);
            color: #fff;
            text-shadow: 3px 3px 0 #000, 0 0 30px rgba(255, 255, 255, 0.5);
            margin-top: 10px; transform: scale(0);
            animation: elasticPop 0.8s 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .continue-msg {
            margin-top: 40px; color: #fff; font-size: 16px; 
            opacity: 0; animation: blink 2s infinite 1s forwards;
            font-weight: bold; letter-spacing: 2px; text-align: center;
        }

        #musicToggle {
            background: #ff0055; color: white; border: none; padding: 8px 15px;
            border-radius: 20px; cursor: pointer; font-weight: bold; font-size: 11px;
            box-shadow: 0 0 10px #ff0055; transition: 0.3s;
        }
        #musicToggle:hover { transform: scale(1.05); }

        .coin {
            position: fixed; width: 40px; height: 40px; background: gold;
            border-radius: 50%; border: 3px solid #daa520;
            display: flex; justify-content: center; align-items: center;
            font-weight: bold; color: #b86e00; font-family: 'Russo One'; font-size: 20px;
            z-index: 10000; animation: fallDown 2.5s linear forwards;
            box-shadow: 0 0 10px gold; pointer-events: none;
        }

        @keyframes rotateSun { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes elasticPop { 0% { transform: scale(0); opacity: 0; } 60% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes blink { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes fallDown { to { transform: translateY(110vh) rotate(720deg); } }
    </style>
</head>
<body>

    <button class="register-call-btn" onclick="openRegisterModal()">üìù CADASTRAR AGORA</button>

    <div id="registerModal" class="modal-overlay">
        <div class="modal-box">
            <button class="btn-close-modal" onclick="closeRegisterModal()">√ó</button>
            <div class="modal-title">CRIE SUA CONTA</div>
            <form onsubmit="submitRegistration(event)">
                <div class="form-group">
                    <label>NOME COMPLETO</label>
                    <input type="text" placeholder="Seu nome aqui" required>
                </div>
                <div class="form-group">
                    <label>E-MAIL</label>
                    <input type="email" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label>CELULAR (WhatsApp)</label>
                    <input type="tel" placeholder="(00) 00000-0000" required>
                </div>
                <button type="submit" class="btn-submit">FINALIZAR CADASTRO</button>
            </form>
        </div>
    </div>

    <div id="winOverlay" onclick="closeOverlay()">
        <div class="sunburst"></div>
        <div id="winTitle" class="win-title">GRANDE GANHO</div>
        <div id="winAmount" class="win-amount">150,00</div>
        <div class="continue-msg">TOQUE PARA CONTINUAR</div>
    </div>

    <div class="machine-container beat-pulse" id="machine">
        <h1>‚ö° FELIPE GAMES ‚ö°</h1>
        
        <div class="hud-container">
            <div class="hud-row">
                <span>Trilha Sonora</span>
                <button id="musicToggle" onclick="toggleMusic()">SOM: OFF üîá</button>
            </div>
            <div class="hud-row">
                <span>SEU SALDO</span>
                <span id="balanceDisplay" class="balance-text">R$ 0,00</span>
            </div>
            <div class="hud-row" style="margin-top: 15px;">
                <label>APOSTA:</label>
                <input type="number" id="betInput" value="10" min="1">
            </div>
        </div>

        <div class="reels-container">
            <div class="reel" id="reel1">üêØ</div>
            <div class="reel" id="reel2">üêØ</div>
            <div class="reel" id="reel3">üêØ</div>
        </div>

        <button id="spinBtn" onclick="spin()">GIRAR AGORA!</button>
    </div>

    <div class="admin-panel">
        <label style="color: #aaa; font-size: 11px; text-transform: uppercase;">üéõÔ∏è Painel do Desenvolvedor (Cheat)</label>
        <div class="slider-container">
            <span>AZAR</span>
            <input type="range" id="probInput" min="0" max="100" value="40" oninput="updateProb(this.value)">
            <span>SORTE</span>
        </div>
        <div style="margin-top: 5px; color: white; font-size: 14px;">
            Probabilidade: <span id="probDisplay" style="color: #ff00de; font-size: 16px;">40</span>%
        </div>
    </div>

    <script>
        // --- FUN√á√ïES DO CADASTRO ---
        function openRegisterModal() {
            document.getElementById('registerModal').style.display = 'flex';
        }

        function closeRegisterModal() {
            document.getElementById('registerModal').style.display = 'none';
        }

        function submitRegistration(event) {
            event.preventDefault(); // N√£o recarrega a p√°gina
            
            // Simula√ß√£o de cadastro
            alert("CADASTRO REALIZADO COM SUCESSO!\nAgora voc√™ pode jogar e sacar seus ganhos.");
            closeRegisterModal();
            
            // ATEN√á√ÉO: Adiciona R$ 50,00 ao saldo aqui
            balance += 50; 
            updateBalanceUI();
            alert("B√îNUS DE BOAS-VINDAS: Voc√™ ganhou R$ 50,00!");
        }

        // --- MOTOR DE √ÅUDIO ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let isMusicPlaying = false;
        let step = 0;
        let timerID;

        const melodySequence = [
            783.99, 783.99, 1046.50, 1318.51, 
            1046.50, 783.99, 659.25, 523.25, 
            587.33, 587.33, 783.99, 987.77, 
            783.99, 587.33, 523.25, 659.25
        ];

        function playNote(freq, type, vol, dur) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + dur);
            osc.start(audioCtx.currentTime);
            osc.stop(audioCtx.currentTime + dur);
        }

        function startAddictiveLoop() {
            if(!isMusicPlaying) return;
            const time = audioCtx.currentTime;
            const note = melodySequence[step % 16];
            
            const currentVol = (step % 4 === 0) ? 0.08 : 0.05; 
            playNote(note, 'triangle', currentVol, 0.1); 

            if (step % 4 === 0) {
                const oscBass = audioCtx.createOscillator();
                const gainBass = audioCtx.createGain();
                oscBass.connect(gainBass); gainBass.connect(audioCtx.destination);
                const bassFreq = (step % 8 === 0) ? 130.81 : 98.00;
                oscBass.type = 'square'; 
                oscBass.frequency.setValueAtTime(bassFreq, time);
                oscBass.frequency.exponentialRampToValueAtTime(bassFreq - 20, time + 0.2);
                gainBass.gain.setValueAtTime(0.2, time);
                gainBass.gain.exponentialRampToValueAtTime(0.001, time + 0.2);
                oscBass.start(time); oscBass.stop(time + 0.2);
            }

            if (step % 2 === 0) {
                 const bufferSize = audioCtx.sampleRate * 0.05;
                 const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
                 const data = buffer.getChannelData(0);
                 for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;
                 const noise = audioCtx.createBufferSource();
                 noise.buffer = buffer;
                 const gainNoise = audioCtx.createGain();
                 noise.connect(gainNoise); gainNoise.connect(audioCtx.destination);
                 gainNoise.gain.value = (step % 4 === 2) ? 0.04 : 0.02;
                 noise.start(time);
            }

            step++;
            timerID = setTimeout(startAddictiveLoop, 110);
        }

        function toggleMusic() {
            const btn = document.getElementById('musicToggle');
            if(audioCtx.state === 'suspended') audioCtx.resume();
            
            isMusicPlaying = !isMusicPlaying;
            if(isMusicPlaying) {
                btn.innerText = "SOM: ON üîä";
                btn.classList.add('on');
                step = 0;
                startAddictiveLoop();
            } else {
                btn.innerText = "SOM: OFF üîá";
                btn.classList.remove('on');
                clearTimeout(timerID);
            }
        }

        let spinSoundTimer;
        function startSpinLoopSound() {
            if(spinSoundTimer) clearInterval(spinSoundTimer);
            spinSoundTimer = setInterval(() => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.05);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.05);
                osc.start(audioCtx.currentTime);
                osc.stop(audioCtx.currentTime + 0.05);
            }, 90);
        }

        function stopSpinLoopSound() {
            clearInterval(spinSoundTimer);
        }

        const symbols = ['üçä', 'üßß', 'üß®', 'üí∞', 'üíé', 'üêØ'];
        
        const payTable = {
            'üçä': { mult: 2,   tier: 'GANHO',            class: 'tier-ganho' },
            'üßß': { mult: 3,   tier: 'GANHO',            class: 'tier-ganho' },
            'üß®': { mult: 5,   tier: 'GRANDE<br>GANHO',  class: 'tier-grande' },
            'üí∞': { mult: 10,  tier: 'SUPER<br>GANHO',   class: 'tier-super' },
            'üíé': { mult: 20,  tier: 'MEGA<br>GANHO',    class: 'tier-mega'  },
            'üêØ': { mult: 50,  tier: 'SUPER MEGA<br>GANHO', class: 'tier-super-mega' }
        };

        // --- ATEN√á√ÉO: Saldo inicial zerado ---
        let balance = 0;
        let winChance = 40;
        const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
        const overlay = document.getElementById('winOverlay');
        const titleEl = document.getElementById('winTitle');
        const amountEl = document.getElementById('winAmount');

        let visualSpinInterval;

        function updateProb(val) {
            winChance = parseInt(val);
            document.getElementById('probDisplay').innerText = val;
        }

        function spin() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const betInput = document.getElementById('betInput');
            const bet = parseInt(betInput.value);
            
            if(bet > balance) { alert("Saldo Insuficiente! Cadastre-se para ganhar b√¥nus."); return; }
            if(isNaN(bet) || bet <= 0) { alert("Aposta inv√°lida"); return; }
            
            betInput.blur();

            balance -= bet;
            updateBalanceUI();
            
            document.getElementById('spinBtn').disabled = true;
            startSpinLoopSound();

            reels.forEach(r => {
                r.classList.add('spinning');
                r.innerText = '‚ùì'; 
            });

            if(visualSpinInterval) clearInterval(visualSpinInterval);
            visualSpinInterval = setInterval(() => {
                reels.forEach(r => {
                    if(r.classList.contains('spinning')) {
                        const randomSym = symbols[Math.floor(Math.random() * symbols.length)];
                        r.innerText = randomSym;
                    }
                });
            }, 100);

            playSound(100, 800, 0.5, 'sawtooth');

            let result = [];
            const isWin = Math.random() * 100 < winChance;

            if(isWin) {
                const s = symbols[Math.floor(Math.random() * symbols.length)];
                result = [s, s, s];
            } else {
                result = [
                    symbols[Math.floor(Math.random() * symbols.length)],
                    symbols[Math.floor(Math.random() * symbols.length)],
                    symbols[Math.floor(Math.random() * symbols.length)]
                ];
                if(result[0] == result[1] && result[1] == result[2]) {
                    result[2] = symbols[(symbols.indexOf(result[2]) + 1) % symbols.length];
                }
            }

            let delay = 600;
            reels.forEach((reel, i) => {
                setTimeout(() => {
                    reel.classList.remove('spinning');
                    reel.innerText = result[i];
                    playNote(100, 'square', 0.2, 0.1);
                    
                    if(i === 2) {
                        clearInterval(visualSpinInterval);
                        stopSpinLoopSound();
                        setTimeout(() => checkResult(result, bet), 300);
                    }
                }, delay);
                delay += 600;
            });
        }

        function playSound(fStart, fEnd, dur, type) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.type = type;
            const now = audioCtx.currentTime;
            osc.frequency.setValueAtTime(fStart, now);
            osc.frequency.linearRampToValueAtTime(fEnd, now + dur);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.linearRampToValueAtTime(0, now + dur);
            osc.start(now); osc.stop(now + dur);
        }

        function checkResult(result, bet) {
            document.getElementById('spinBtn').disabled = false;
            
            if(result[0] === result[1] && result[1] === result[2]) {
                const sym = result[0];
                const info = payTable[sym];
                const winAmount = bet * info.mult;
                
                balance += winAmount;
                updateBalanceUI();
                
                showWinScreen(info.tier, winAmount, info.class);
            }
        }

        function showWinScreen(text, amount, cssClass) {
            titleEl.innerHTML = text; 
            titleEl.className = "win-title " + cssClass;
            amountEl.innerHTML = "";
            overlay.style.display = 'flex';
            animateValue(amountEl, 0, amount, 1500);
            playWinSound();
            spawnCoins(50);
        }

        function closeOverlay() {
            overlay.style.display = 'none';
        }

        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const currentVal = Math.floor(progress * (end - start) + start);
                obj.innerHTML = "R$ " + currentVal.toLocaleString('pt-BR', {minimumFractionDigits: 2});
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        function playWinSound() {
            const now = audioCtx.currentTime;
            const notes = [523.25, 659.25, 783.99, 1046.50, 1318.51, 1567.98, 2093.00]; 
            notes.forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.type = 'sawtooth';
                osc.frequency.value = freq;
                osc.start(now + i*0.08); 
                osc.stop(now + i*0.08 + 0.4);
                gain.gain.setValueAtTime(0.1, now + i*0.08);
                gain.gain.linearRampToValueAtTime(0, now + i*0.08 + 0.4);
            });
        }

        function spawnCoins(amount) {
            for(let i=0; i<amount; i++) {
                const coin = document.createElement('div');
                coin.classList.add('coin');
                coin.innerText = "R$";
                coin.style.left = Math.random() * 90 + "vw"; 
                coin.style.top = -50 + "px";
                coin.style.animationDuration = (Math.random() * 2 + 1.5) + "s";
                document.body.appendChild(coin);
                setTimeout(() => coin.remove(), 4000);
            }
        }

        function updateBalanceUI() {
            document.getElementById('balanceDisplay').innerText = "R$ " + balance.toLocaleString('pt-BR', {minimumFractionDigits: 2});
        }
    </script>
</body>
</html>